# 현실에서의 함수형 사고

- 현실적인 문제에 함수형 사고를 적용해 본다.
- 소프트웨어 구조를 잡는데 계층형 설계가 좋은 이유를 설명한다.
- 액션을 타임라인으로 시각화한다.
- 타임라인을 사용하면 시간에 관한 문제를 잘 풀 수 있다는 것을 배운다.

## 액션과 계산, 데이터

액션은 호출 횟수와 시점에 의존한다.

계산은 어떤 것을 결정하거나 계획한다.
계산은 실행해도 다른 곳에 영향을 주지 않는다.
아무때나 사용해도 좋다.

데이터는 유연하기 때문에 다양하게 쓰일 수 있다.

## 변경 가능성에 따라 코드 나누기

위쪽으로 갈수록 자주 바뀌는 코드가 있고 아래쪽으로 갈수록 자주 바뀌지 않는 코드가 있다.
각 계층은 아래에 있는 계층을 기반으로 만들어진다.

계층형 설계는 비즈니스 규칙, 도메인 규칙, 기술 스택 계층으로 나눈다.

## 일급 추상

**타임라인 다이어그램**을 사용하면 액션이 시간 순서에 따라 어떻게 실행되는지 볼 수 있다.
액션은 실행 시점에 의존하기 때문에 실행 순서가 중요하다.

## 분산 시스템을 타임라인으로 시각화하기

여러 대의 로봇이 함께 일을 하는 것은 분산 시스템을 의미한다.
분산 시스템에서 독립된 액션의 실행 순서는 예상치 못한 상황을 유발한다.

## 각각의 타임라인은 다른 순서로 실행됩니다

기본적으로 타임라인은 서로 순서를 맞추는 기능이 없다.
다른 타임라인 작업이 끝날 때까지 기다리라는 표시가 없어서 순서대로 다음 단계를 진행한다.
서로 다른 타임라인에 있는 액션 간 실행 순서는 보장할 수 없다.
결국 타임라인을 서로 맞추지 않은 분산 시스템은 예측 불가능한 순서로 실행된다.

정리하면 다음과 같다.

1. 기본적으로 타임라인은 서로 순서를 맞추지 않는다.
2. 액션이 실행되는 순서는 중요하지 않다.
3. 드물지만 타이밍이 어긋나는 경우는 실제 일어난다.
4. 타임라인 다이어그램으로 시스템의 문제를 알 수 있다.

## 타임라인 커팅: 로봇이 서로를 가디릴 수 있게 하기

타임라인의 시간을 맞추는 작업을 **커팅**이라고 부른다.
타임라인 커팅은 **고차 동작**(high-order operation)으로 구현한다.
각 타임라인은 독립적으로 동작하고 작업이 완료되면 다른 타임라인 끝나기를 기다리기 때문에 어떤 타임라인이 먼저 끝나도 괜찮다.

1. 타임라인 커팅으로 서로 다른 작업들을 쉽게 이해할 수 있다.
2. 타임라인 다이어그램을 사용하면 시간에 따라 진행하는 작업을 쉽게 이해할 수 있다.
3. 타임라인 다이어그램은 유연하다.
